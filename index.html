<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cartoon Channel — Secure Player</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header class="site-header">
    <h1>Cartoon Channel</h1>
  </header>

  <main class="container">
    <div class="player-wrap">
      <video id="video" controls playsinline width="800" poster="">
        Your browser does not support HTML5 video.
      </video>
    </div>
    <p class="hint">এই প্লেয়ারটি সার্ভার-প্রক্সি ব্যবহার করে কন্টেন্ট লোড করে — আসল m3u8 লিংক গোপন রাখা আছে।</p>
  </main>

  <!-- hls.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.1/dist/hls.min.js"></script>
  <script>
    async function initPlayer() {
      const video = document.getElementById('video');
      // এখানে টোকেন নাই — সরাসরি our proxy route ব্যবহার করতে হবে
      const playlistUrl = '/api/video';

      if (window.Hls && Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(playlistUrl);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, function() {
          // optional: video.play();
        });
        hls.on(Hls.Events.ERROR, function(event, data) {
          console.error('HLS error', event, data);
        });
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = playlistUrl;
      } else {
        document.querySelector('.hint').innerText = 'আপনার ব্রাউজার HLS সাপোর্ট করছে না।';
      }
    }

    initPlayer();
  </script>
</body>
</html>
